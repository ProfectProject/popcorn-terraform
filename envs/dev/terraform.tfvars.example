# 환경 설정
region = "ap-northeast-2"

# VPC 설정 - 단일 AZ (비용 절감)
vpc_name = "popcorn-dev-vpc"
vpc_cidr = "10.0.0.0/16"

public_subnets = [
  {
    name = "popcorn-dev-public-2a"
    az   = "ap-northeast-2a"
    cidr = "10.0.1.0/24"
  }
]

private_subnets = [
  {
    name = "popcorn-dev-private-2a"
    az   = "ap-northeast-2a"
    cidr = "10.0.11.0/24"
  }
]

data_subnets = [
  {
    name = "popcorn-dev-data-2a"
    az   = "ap-northeast-2a"
    cidr = "10.0.21.0/24"
  }
]

enable_nat         = true
single_nat_gateway = true # Dev: 단일 NAT Gateway (비용 절감)

# Public ALB 설정
public_alb_name               = "popcorn-dev-public-alb"
public_alb_target_group_name  = "popcorn-dev-public-tg"
public_alb_target_group_port  = 8080
public_alb_health_check_path  = "/actuator/health"

# Management ALB 설정
management_alb_name               = "popcorn-dev-mgmt-alb"
management_alb_target_group_name  = "popcorn-dev-mgmt-tg"
management_alb_target_group_port  = 8080
management_alb_health_check_path  = "/health"

# Management ALB 화이트리스트 IP
whitelist_ips = [
  "203.0.113.0/32", # 개발팀 사무실 IP (예시)
  "198.51.100.0/32" # VPN 서버 IP (예시)
]

# ElastiCache 설정 - 단일 노드 (비용 절감)
elasticache_name                  = "popcorn-dev-cache"
elasticache_node_type             = "cache.t4g.micro"
elasticache_engine_version        = "8.0"
elasticache_num_cache_clusters    = 1     # Dev: 단일 노드
elasticache_automatic_failover    = false # Dev: 비활성화
elasticache_multi_az_enabled      = false # Dev: 단일 AZ

# RDS 설정 - 단일 AZ (비용 절감)
rds_identifier                   = "popcorn-dev-postgres"
rds_instance_class               = "db.t4g.micro"
rds_allocated_storage            = 20
rds_engine_version               = "16.1"
rds_multi_az                     = false # Dev: 단일 AZ
rds_backup_retention_period      = 1     # Dev: 1일 백업
rds_backup_window                = "02:00-04:00"
rds_maintenance_window           = "sun:04:00-sun:06:00"
rds_performance_insights_enabled = false # Dev: 비활성화

# IAM 설정
iam_name = "popcorn-dev"

# EKS 설정 - 최소 구성 (비용 절감)
eks_name                  = "popcorn-dev-eks"
eks_cluster_version       = "1.34"
eks_node_instance_types   = ["t3.medium"]
eks_node_capacity_type    = "ON_DEMAND"
eks_node_min_size         = 2
eks_node_max_size         = 5
eks_node_desired_size     = 2

# 공통 태그
tags = {
  Environment = "dev"
  Project     = "goorm-popcorn"
  ManagedBy   = "terraform"
  CostCenter  = "development"
}
